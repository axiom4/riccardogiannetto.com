<div #container class="gallery-lightbox-container">
  @for (item of galleryItems(); track item.data.url; let i = $index) {
    <div
      class="gallery-img"
      [ngClass]="'item-' + item.cols + 'x' + item.rows"
      [style.grid-column-start]="item.gridColumnStart"
      [style.grid-row-start]="item.gridRowStart"
    >
      <img
        #galleryImg
        (click)="onPreviewImage(i)"
        alt="{{ item.data.title }}"
        onKeyPress=""
        onKeyDown=""
        onKeyUp=""
        src="{{ item.data.url }}/width/{{ getGalleryPreviewWidth() }}"
        width="{{ getGalleryPreviewWidth() }}"
        height="{{
          getGalleryPreviewHeight(item.data.width, item.data.height)
        }}"
        srcset="{{ item.data.url }}/width/400 400w, {{
          item.data.url
        }}/width/600 600w, {{ item.data.url }}/width/800 800w, {{
          item.data.url
        }}/width/1000 1000w, {{ item.data.url }}/width/1200 1200w"
        sizes="{{
          item.cols === 2
            ? '(max-width: 650px) 100vw, (max-width: 1024px) 100vw, (max-width: 1500px) 66vw, 50vw'
            : '(max-width: 650px) 100vw, (max-width: 1024px) 50vw, (max-width: 1500px) 33vw, 25vw'
        }}"
        priority
        placeholder
      />
    </div>
  }
  @if (showMask()) {
    <div class="lightbox" [@animation-leave]="{ value: 'hide' }">
      <span class="count"> {{ imageNum }}/{{ totalImageCount }} </span>
      @if (previewImage()) {
        <button
          type="button"
          (click)="onclosePreview()"
          class="close-btn"
          title="Close"
        >
          <span
            class="icon-lightbox-carousel"
            onKeyPress=""
            onKeyDown=""
            onKeyUp=""
          >
            Close
          </span>
        </button>
      }
      @if (controls) {
        <button
          type="button"
          class="btn-lightbox-carousel btn-prev"
          title="Previous"
          (click)="prev()"
        >
          <span class="icon-lightbox-carousel">Prev</span>
        </button>
      }
      @if (controls) {
        <button
          type="button"
          class="btn-lightbox-carousel btn-next"
          title="Next"
          (click)="next()"
        >
          <span class="icon-lightbox-carousel">Next</span>
        </button>
      }
      @if (previewImage()) {
        <div
          [@animation-enter]="{ value: 'visible' }"
          (@animation-enter.done)="onAnimationEnd($event)"
          class="lightbox-img"
        >
          @if (currentLightboxImg()) {
            <img
              #galleryPreviewImg
              alt="{{ currentLightboxImg()!.title }}"
              src="{{ currentLightboxImg()!.url }}/width/{{
                getLightboxRenderWidth()
              }}"
              width="{{
                getGalleryImageWidth(
                  currentLightboxImg()!.width,
                  currentLightboxImg()!.height
                )
              }}"
              height="{{
                getGalleryImageHeight(
                  currentLightboxImg()!.width,
                  currentLightboxImg()!.height
                )
              }}"
              priority
            />
          }
          <span class="signature">R.G.</span>
        </div>
      }
    </div>
  }
</div>
