{% extends "admin/change_form.html" %} {% block after_field_sets %} {{ block.super }} {% if original.latitude and original.longitude %}
<div style="margin: 20px 0; padding: 10px; background: white; border: 1px solid #ccc">
  <h2>Location Map</h2>
  <div id="map" style="height: 400px; width: 100%"></div>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      var lat = "{{ original.latitude|stringformat:'f' }}";
      var lon = "{{ original.longitude|stringformat:'f' }}";
      var map = L.map("map").setView([lat, lon], 13);

      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        maxZoom: 19,
        attribution: "Â© OpenStreetMap",
      }).addTo(map);

      L.marker([lat, lon]).addTo(map).bindPopup('{{ original.city|default:"Unknown City" }}, {{ original.country|default:"Unknown Country" }}').openPopup();
    });
  </script>
</div>
{% endif %} {% endblock %}
